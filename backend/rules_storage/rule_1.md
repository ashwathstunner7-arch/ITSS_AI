# Kony Frontend

**Category:** logic
**Version:** 1.0
**Priority:** medium
**Description:** Kony Development Guidlines

## Rule Content

# Visualizer Development Guidelines

## Introduction

These guidelines provide a standardized approach for developing robust, scalable, and maintainable applications in the Kony Visualizer environment. Following these practices ensures clarity, consistency, and quality across all projects.

## Naming Conventions

###Golden Rule
-always follow the Kony MVC lifecycle when generating code — Form(UI) → Presentation Controller (must follow Sample Service Call)→ Business Controller (must follow Sample Service Call) → Service Layer -> accessibility.js (sample structure accessibility.js).
-always follow the Standard Component Structure when working with Kony components (with or without contracts) — first refer to Kony Docs https://docs.kony.com/konylibrary/visualizer/visualizer_user_guide/Content/C_DesigningWorkingWithComponents.htm – Designing and Working with Components, then use the provided Sample Structure For component controller as the standard template.
-Always follow: Apply accessibility dynamically only in postShow(), never hard-code form or widget references, always use a reusable accessibility utility with runtime widget references, include the accessibility file via a dynamic lifecycle argument, strictly follow the #accessibility sample structure, and pass every dynamically generated widget as an argument after rendering.

### General Rules
- All code must strictly follow the Kony Visualizer form lifecycle (onNavigate() → init() → preShow() → postShow() → event handlers -> accessibility.js).No widget manipulation, service calls, or business logic should exist outside the correct lifecycle stage.
- Avoid autogenerated IDs like `CopyflexAccountsDetailsHeader0243d36df72834d`
- Use clear, semantically meaningful names
- Append suffix "KA" to distinguish from vertical app widgets
- Form Layer: Handle UI lifecycle & events, prepare request, check network, call Presentation method.
- Presentation Layer: No service logic; call Business method with success/error callbacks; update UI only in callbacks.
- Business Layer: No UI logic; perform object/service calls, return results via callbacks.
- For any Kony service call, should strictly use the below Sample Service Call without deviation.
- Always follow: Apply accessibility dynamically only in postShow(), never hard-code form or widget references, always use a reusable accessibility utility with runtime widget references, include the accessibility file via a dynamic lifecycle argument, strictly follow the #accessibility sample structure, and pass every dynamically generated widget as an argument after rendering.

### Widget Naming Pattern

| Widget Type       | Prefix Example             |
|-------------------|----------------------------|
| Form              | frmFormNameKA              |
| Popup             | frmPopupNameKA             |
| Button            | btnButtonNameKA            |
| Segment           | segSegmentNameKA           |
| Skin              | sknSkinNameKA              |
| Image             | imgImageNameKA             |
| Label             | lblLabelNameKA             |
| Listbox           | lbxListboxNameKA           |
| Textbox           | tbxTextboxNameKA           |
| Textarea          | txtTextareaNameKA          |
| Checkbox Group    | cbxCheckboxNameKA          |
| Radio Group       | rbnRadiobuttonNameKA       |
| RichText          | rtxRichtextNameKA          |
| PickerView        | pkrPickerNameKA            |
| Calendar          | calCalendarNameKA          |
| Flex Container    | flxContainerNameKA         |
| Camera            | camNameKA                  |
| Browser           | bsrBrowserNameKA           |
| DataGrid          | grdGridNameKA              |
| Map               | mapMapNameKA               |
| Tab               | tabTabNameKA               |
| Header Template   | hdrHeaderNameTmplKA        |
| Footer Template   | ftrFooterNameTmplKA        |
| Segment Template  | segNameTmplKA              |
| Map Template      | mapNameTmplKA              |
| GridCalendar Tmpl | grdNameTmplKA              |
| Resources         | resourcename.png           |
| Global Variables  | gblVariableNameKA          |
| i18n Key Format   | i18n.modulename.formname.widgetname |

## Module Naming
- Utility/Common modules: `calendarUtilities.js` (camelCase, starts lowercase)
- MDA modules: Named by category
- MVC modules: Prefix with form name

## Variable Scoping
- Always declare with var (or let/const if supported).
- Limit scope to where variables are used

## Modularity
- Each function should perform one task
- Keep function size between 10–15 lines
- Split large tasks into smaller, focused functions
- Reuse lifecycle methods & helper functions instead of duplicating code.


## Logging Practices
- Always log callback errors
- Use kony.print() for platform-agnostic logging in production or across devices.

## Exception Handling
- Use `try-catch` in all methods
- Provide informative custom error messages
- Avoid silent failures

## Function Design Best Practices
- Use object parameters if more than 5 parameters
- Remove redundant logic via reusable functions
- Document functions using JSDoc: http://usejsdoc.org

## Looping and Iteration
```javascript
var length = getProductLength();
for (var i = 0; i < length; i++) {
    // logic
}
```
- Avoid recalculating conditions in loop
- Use constants where appropriate

## Regular Expressions
- Use for input validation
- Always include user-friendly error messages

## Platform Optimizations
- Cache common values (e.g., screenWidth)
- Use `forceLayout` cautiously—only on parents of modified widgets

## Resource Management
- Use appropriately named folders for different image resolutions
- Ensure consistent performance across devices

## Code Formatting & Static Analysis
- Use [jsbeautifier](http://jsbeautifier.org/) for formatting
- Use [jshint](http://jshint.com/) for linting and analysis

## MDA Architecture

| Layer                | Responsibility                                      |
|----------------------|------------------------------------------------------|
| **View Controller**   | UI event handling, UI lifecycle                     |
| **Form Controller**   | Manage UI, events, navigation, data binding         |
| **Presentation Ctrl** | Business logic, coordination between UI & service   |
| **Business Controller**| Handles shared complex logic, object service calls |

### MDA Best Practices
- View belongs to one module only
- Avoid sharing views across modules
- Pass data, not object instances
- Avoid anonymous callbacks
- Use unique MF objects
- Use Manager classes for CRUD

## General Development Guidelines

- Function names: Use camelCase and make them meaningful
- Document with JSDoc
- Avoid duplicate code—use utility functions
- Always null-check before accessing nested properties
- Keep deprecated CSS tracked separately
- Store custom CSS in `CustomSkinDW`
- Prefer contract-only components
- Separate concerns: UI, logic, services
- Modify i18n files only through Visualizer
- Consolidate common logic into shared utilities
- Check references before renaming widgets/skins
- Avoid modifying shared skins
- Place constants in a central file
- Remove unused or commented-out code

## i18n (Internationalization) Guidelines
- Use kony.i18n.getLocalizedString() for all static text and error messages.
  Example: kony.i18n.getLocalizedString("i18n.settings.emailLengthError")

- Follow structured key naming:
  Format: i18n.moduleName.formName.widgetName

- Update i18n files only through Kony Visualizer to avoid merge conflicts.

## init Function Guidelines
- Define an init() function to:
  - Set default values or states

- Call preShow() during the form lifecycle, preferably inside init.
  Example: this.preShow();

- init() should be the first function executed in the form lifecycle.


## Sample Service Call
-Form Level (UI):
<FunctionName>: function() {
 
        var request = {
            // Add request params here
        };
        var AppGroup = kony.mvc.MDAApplication.getSharedInstance()
            .getModuleManager()
            .getModule({
                "appName": "<AppName>",
                "moduleName": "<ModuleName>"
            });
        AppGroup.presentationController.<FunctionName>(request);
        applicationManager.getPresentationUtility().showLoadingScreen();
},

<FunctionName>Success : function(response){

},

<FunctionName>Failure: function(error){

},

-Presentation Controller:
PresentationController_Mobile.prototype.<FunctionName> = function(request) {
    applicationManager.get<ManagerName>().<FunctionName>(
        request,
        this.<FunctionName>SuccessCallback,
        this.<FunctionName>ErrorCallback
    );
};
PresentationController_Mobile.prototype.<FunctionName>SuccessCallback = function(response) {
    var viewController = applicationManager.getPresentationUtility()
        .getController(kony.application.getCurrentForm().id, true);
    viewController.<FunctionName>Success(response);
};
PresentationController_Mobile.prototype.<FunctionName>ErrorCallback = function(error) {
    var viewController = applicationManager.getPresentationUtility()
        .getController(kony.application.getCurrentForm().id, true);
    viewController.<FunctionName>Failure(error);
};

-Business Controller:
BusinessController.prototype.<FunctionName> = function(params, successCB, errorCB) {
    var serviceName = "<ServiceName>";
    var serviceType = "online";
    var objSvc = kony.sdk.getCurrentInstance().getObjectService(serviceName, { "access": serviceType });
    var objectName = "<ObjectName>";
    var dataObject = new kony.sdk.dto.DataObject(objectName);
    var bodyContent = {
        // Add key-value pairs
    };
    var options = {
        "dataObject": dataObject,
        "queryParams": bodyContent,
        "headers": {}
    };
    var verbName = "<VerbName>";
    objSvc.customVerb(verbName, options, successCB, errorCB);
};

-accessibility.js (utility)
define(function () {

    function setAccessibilityConfig(widget, label, hidden) {
        if (widget) {
            widget.accessibilityConfig = {
                a11yLabel: label || "",
                a11yHidden: hidden || false
            };
        }
    }

    // Accepts array of widget accessibility data
    function accessibiltyWidgetData(widgetDataArray) {

        if (!Array.isArray(widgetDataArray)) {
            return;
        }

        widgetDataArray.forEach(function (item) {
            if (item.widget && item.label) {
                setAccessibilityConfig(item.widget, item.label, false);
            }
        });
    }

    return {
        accessibiltyWidgetData: accessibiltyWidgetData
    };
});


##Sample structure accessibility 
-Form Level (UI):
define(["accessibility"], function (accessibility) {
    return {

        onNavigate: function () {
            this.view.preShow = this.preShow;
            this.view.postShow = this.postShow;
        },

        postShow: function () {

            // Accessibility data must include all widgets during generation
            var accessibilityWidgetMap = [
                {
                    widget: this.view.txtCheckAssibility,
                    label: this.view.txtCheckAssibility.text
                },
                {
                    widget: this.view.lblAssebility,
                    label: this.view.lblAssebility.text
                },
                {
                    widget: this.view.Label0ie1ca99d5f4942,
                    label: this.view.Label0ie1ca99d5f4942.text
                },
                {
                    widget: this.view.Image0c304b2a48c174d,
                    label: "Aspire Logo"
                }
            ];

            // Call accessibility only after UI render
            accessibility.accessibiltyWidgetData(accessibilityWidgetMap);
        }
    };
});

-accessibility.js (utility)
define(function () {

    function setAccessibilityConfig(widget, label, hidden) {
        if (widget) {
            widget.accessibilityConfig = {
                a11yLabel: label || "",
                a11yHidden: hidden || false
            };
        }
    }

    // Accepts array of widget accessibility data
    function accessibiltyWidgetData(widgetDataArray) {

        if (!Array.isArray(widgetDataArray)) {
            return;
        }

        widgetDataArray.forEach(function (item) {
            if (item.widget && item.label) {
                setAccessibilityConfig(item.widget, item.label, false);
            }
        });
    }

    return {
        accessibiltyWidgetData: accessibiltyWidgetData
    };
});



## Sample Structure For component controller

- With contract 
define(function() {
    return {
        constructor: function(baseConfig, layoutConfig, pspConfig) {
            // Initialize component
            this.initializeComponent();
        },
        
        // Contract implementation methods
        initGettersSetters: function() {
            // Define public properties and methods
            // Implement contract-defined getters/setters
        },
        
        // Private methods (prefixed with underscore)
        _privateMethod: function() {
            // Internal component logic
        },
        
        // Public methods (exposed through contract)
        publicMethod: function() {
            // Methods accessible to component consumers
        },
        
        // Event handlers
        onEventHandler: function() {
            // Handle component events
        },
        
        // Lifecycle methods
        preShow: function() {
            // Pre-show logic
        },
        
        postShow: function() {
            // Post-show logic
        }
    };
});

- without contract
define({
  // variables
  isFormatSet: false,

  // lifecycle hook
  preShow: function() {
    // initialization logic
  },

  // event handler example
  onKeyUp: function(eventobject) {
    // handle key input
  },

  // utility method example
  getDate: function() {
    return "";
  }

  // more helpers as needed...
});
